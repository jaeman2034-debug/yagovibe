# ðŸ” ì˜¤ë¥˜ ì›ì¸ ë°œê²¬

## ðŸŽ¯ í•µì‹¬ ë¬¸ì œ

**ì¸ì•± ë¸Œë¼ìš°ì € ê°ì§€ ë¡œì§ì´ ë„ˆë¬´ ì—„ê²©í•´ì„œ ì¼ë°˜ Chrome ë¸Œë¼ìš°ì €ë„ ê°ì§€í•˜ê³  ìžˆìŠµë‹ˆë‹¤.**

### ì¦ê±°

1. **í˜„ìž¬ íŽ˜ì´ì§€**: `/in-app` ê²½ë¡œ
2. **ë©”ì‹œì§€**: "ì•± ë‚´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
3. **Network íƒ­**: ëª¨ë“  ìš”ì²­ì´ 200ìœ¼ë¡œ ì„±ê³µí•˜ì§€ë§Œ `/__/auth/handler` ìš”ì²­ì´ ì—†ìŒ
4. **ì›ì¸**: ë¡œê·¸ì¸ í”Œë¡œìš° ì¤‘ì— `/in-app`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë˜ì–´ ë¡œê·¸ì¸ì´ ì¤‘ë‹¨ë¨

## ðŸ“‹ ë¬¸ì œ ë¶„ì„

### 1. ì¸ì•± ë¸Œë¼ìš°ì € ê°ì§€ ë¡œì§ (`App.tsx`)

```typescript
// í˜„ìž¬ ë¡œì§ì´ ë„ˆë¬´ ì—„ê²©í•¨
const isInApp = (isInAppByUA || (!isStandalone && isInAppBySize) || isStorageRestricted) && !isChrome && !isSafari;
```

**ë¬¸ì œì **:
- `isInAppBySize` ì¡°ê±´ì´ ë„ˆë¬´ ì—„ê²©í•¨
- `heightDiff > 200` ì¡°ê±´ì´ ì¼ë°˜ ë¸Œë¼ìš°ì €ì—ì„œë„ trueê°€ ë  ìˆ˜ ìžˆìŒ
- ë¡œê·¸ì¸ í”Œë¡œìš° ì¤‘ì—ë„ ê°ì§€ê°€ ìž‘ë™í•¨

### 2. ë¡œê·¸ì¸ í”Œë¡œìš° ì¤‘ë‹¨

1. ì‚¬ìš©ìžê°€ "G êµ¬ê¸€ë¡œ ë¡œê·¸ì¸" í´ë¦­
2. Firebase Auth íŒì—…/redirect ì‹œìž‘
3. **ì¸ì•± ë¸Œë¼ìš°ì € ê°ì§€ ë¡œì§ì´ ìž‘ë™**
4. `/in-app` íŽ˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
5. **ë¡œê·¸ì¸ í”Œë¡œìš° ì¤‘ë‹¨**
6. `/__/auth/handler` ìš”ì²­ì´ ë°œìƒí•˜ì§€ ì•ŠìŒ

### 3. Firebase Auth iframe ìš”ì²­

- Network íƒ­ì— `/auth/iframe?apiKey=...` ìš”ì²­ë“¤ì´ ë³´ìž„
- ì´ëŠ” Firebase Authê°€ íŒì—… ëŒ€ì‹  iframeì„ ì‚¬ìš©í•˜ë ¤ê³  ì‹œë„í•œ ê²ƒ
- í•˜ì§€ë§Œ `/in-app`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë˜ì–´ ì¤‘ë‹¨ë¨

## ðŸš€ í•´ê²° ë°©ë²•

### ë°©ë²• 1: ë¡œê·¸ì¸ í”Œë¡œìš° ì¤‘ ì¸ì•± ë¸Œë¼ìš°ì € ê°ì§€ ë¹„í™œì„±í™” (ê¶Œìž¥)

```typescript
// App.tsxì˜ InAppBrowserRedirect ì»´í¬ë„ŒíŠ¸ ìˆ˜ì •
useEffect(() => {
  // /in-app íŽ˜ì´ì§€ì—ì„œëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ì§€ ì•ŠìŒ
  if (location.pathname === "/in-app") {
    return;
  }

  // ðŸ”¥ ë¡œê·¸ì¸ í”Œë¡œìš° ì¤‘ì—ëŠ” ì¸ì•± ë¸Œë¼ìš°ì € ê°ì§€ ë¹„í™œì„±í™”
  const isLoginFlow = 
    location.pathname === "/login" || 
    location.pathname === "/signup" ||
    location.pathname.includes("/__/auth/");
  
  if (isLoginFlow) {
    console.log("ðŸ”§ [React] ë¡œê·¸ì¸ í”Œë¡œìš° ì¤‘ - ì¸ì•± ë¸Œë¼ìš°ì € ê°ì§€ ë¹„í™œì„±í™”");
    return;
  }

  // ... ê¸°ì¡´ ê°ì§€ ë¡œì§
}, [location.pathname]);
```

### ë°©ë²• 2: ì¸ì•± ë¸Œë¼ìš°ì € ê°ì§€ ë¡œì§ ì™„í™”

```typescript
// ë” ì •í™•í•œ ê°ì§€ ë¡œì§
const isInAppBySize = 
  !isChrome && !isSafari && (
    heightDiff > 300 || // ë” í° ìž„ê³„ê°’ (200 â†’ 300)
    (window.outerWidth === 0 && window.innerWidth > 0) ||
    (heightDiff === 0 && widthDiff === 0 && !isStandalone && window.innerWidth < 300) // 400 â†’ 300
  );
```

### ë°©ë²• 3: User Agent ê¸°ë°˜ ê°ì§€ë§Œ ì‚¬ìš©

```typescript
// User Agent ê¸°ë°˜ ê°ì§€ë§Œ ì‚¬ìš© (ê°€ìž¥ ì•ˆì „)
const isInApp = isInAppByUA && !isChrome && !isSafari;
```

## ðŸ“‹ ì¦‰ì‹œ ì ìš©í•  ìˆ˜ì •

ê°€ìž¥ ë¹ ë¥¸ í•´ê²°ì±…ì€ **ë¡œê·¸ì¸ í”Œë¡œìš° ì¤‘ì—ëŠ” ì¸ì•± ë¸Œë¼ìš°ì € ê°ì§€ë¥¼ ë¹„í™œì„±í™”**í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤.

