# 🔥 Google 로그인 문제 해결 - 단계별 가이드

## Step 1: OAuth 동의 화면 > 테스트 사용자 추가 (가장 중요!)

### 1-1. Google Cloud Console 접속

1. **브라우저에서 다음 주소 열기**
   ```
   https://console.cloud.google.com
   ```

2. **프로젝트 선택**
   - 상단 중앙의 프로젝트 선택 드롭다운 클릭
   - **"yago-vibe-spt"** 프로젝트 선택

### 1-2. OAuth 동의 화면으로 이동

1. **왼쪽 메뉴에서 찾기**
   - 왼쪽 사이드바에서 **"API 및 서비스"** 클릭
   - 하위 메뉴에서 **"OAuth 동의 화면"** 클릭

   또는

2. **검색으로 찾기**
   - 상단 검색창에 **"OAuth 동의 화면"** 입력
   - 검색 결과에서 **"OAuth 동의 화면"** 클릭

### 1-3. 테스트 사용자 추가

1. **"테스트 사용자" 섹션 찾기**
   - 페이지를 아래로 스크롤
   - **"테스트 사용자"** 섹션 찾기

2. **사용자 추가**
   - **"+ 사용자 추가"** 또는 **"사용자 추가"** 버튼 클릭
   - 입력 필드에 이메일 입력: `jaeman2034@gmail.com`
   - **"저장"** 또는 **"추가"** 버튼 클릭

3. **확인**
   - 테스트 사용자 목록에 `jaeman2034@gmail.com`이 표시되는지 확인

### 1-4. 사용자 지원 이메일 확인 (선택사항)

1. **"앱 정보" 섹션 확인**
   - 페이지 상단의 **"앱 정보"** 섹션 확인
   - **"사용자 지원 이메일"** 필드 확인
   - 실제 이메일 주소로 설정되어 있는지 확인
   - 없으면 설정: `jaeman2034@gmail.com`

---

## Step 2: Identity Toolkit API 활성화 확인

### 2-1. API 라이브러리로 이동

1. **왼쪽 메뉴에서 찾기**
   - 왼쪽 사이드바에서 **"API 및 서비스"** 클릭
   - 하위 메뉴에서 **"라이브러리"** 클릭

   또는

2. **검색으로 찾기**
   - 상단 검색창에 **"API 라이브러리"** 입력
   - 검색 결과에서 **"API 라이브러리"** 클릭

### 2-2. Identity Toolkit API 검색

1. **검색창에 입력**
   - 페이지 상단의 검색창에 **"Identity Toolkit API"** 입력
   - Enter 키 누르기 또는 검색 아이콘 클릭

2. **결과에서 선택**
   - 검색 결과에서 **"Identity Toolkit API"** 클릭

### 2-3. 활성화 상태 확인 및 활성화

1. **활성화 상태 확인**
   - 페이지 상단에 **"사용 설정됨"** 또는 **"관리"** 버튼이 보이면 → **이미 활성화됨** ✅
   - **"사용 설정"** 버튼이 보이면 → **비활성화 상태** ❌

2. **활성화하기 (비활성화인 경우)**
   - **"사용 설정"** 버튼 클릭
   - 잠시 대기 (몇 초 소요)
   - **"사용 설정됨"** 상태로 변경되는지 확인

---

## Step 3: 브라우저 캐시 완전 삭제

### 3-1. Chrome 캐시 삭제

1. **캐시 삭제 창 열기**
   - 키보드 단축키: **Ctrl + Shift + Delete**
   - 또는 Chrome 메뉴 (⋮) > **"기록 삭제"** 클릭

2. **설정 선택**
   - **"기간"** 드롭다운에서 **"전체 기간"** 선택
   - 다음 항목 체크:
     - ✅ **"캐시된 이미지 및 파일"**
     - ✅ **"쿠키 및 기타 사이트 데이터"**
   - 다른 항목은 체크 해제해도 됨

3. **삭제 실행**
   - **"데이터 삭제"** 버튼 클릭
   - 완료될 때까지 대기 (몇 초 소요)

### 3-2. 쿠키 허용 확인

1. **Chrome 설정 열기**
   - Chrome 주소창에 `chrome://settings/cookies` 입력
   - Enter 키 누르기

2. **쿠키 설정 확인**
   - **"모든 쿠키 허용"** 또는 **"사이트에서 쿠키 저장 및 읽기 허용"** 선택되어 있는지 확인
   - 다르게 설정되어 있으면 변경

---

## Step 4: 시크릿 모드에서 테스트

### 4-1. 시크릿 모드 열기

1. **시크릿 창 열기**
   - 키보드 단축키: **Ctrl + Shift + N**
   - 또는 Chrome 메뉴 (⋮) > **"새 시크릿 창"** 클릭

2. **확인**
   - 시크릿 모드 창이 열리면 주소창 왼쪽에 **"시크릿"** 아이콘 표시됨

### 4-2. 개발 서버 접속

1. **주소 입력**
   - 주소창에 다음 입력: `http://localhost:5173`
   - Enter 키 누르기

2. **로그인 페이지로 이동**
   - 주소창에 다음 입력: `http://localhost:5173/login`
   - Enter 키 누르기

### 4-3. Google 로그인 테스트

1. **Google 로그인 버튼 클릭**
   - 페이지에서 **"구글로 로그인"** 버튼 찾기
   - 버튼 클릭

2. **팝업 확인**
   - Google 로그인 팝업 창이 열리는지 확인
   - 팝업이 차단되면 주소창 오른쪽 팝업 차단 아이콘 클릭
   - **"항상 localhost:5173의 팝업 허용"** 선택

3. **로그인 진행**
   - Google 계정 선택 (또는 이메일 입력)
   - 비밀번호 입력
   - 로그인 완료

4. **결과 확인**
   - 팝업이 자동으로 닫히고 메인 페이지로 이동하는지 확인
   - 로그인 성공 시 사용자 정보가 표시되는지 확인

---

## Step 5: 팝업 차단 해제 (필요한 경우)

### 5-1. 팝업 차단 아이콘 확인

1. **Google 로그인 버튼 클릭 후**
   - 주소창 오른쪽에 **팝업 차단 아이콘** (🚫) 표시되는지 확인

2. **팝업 허용**
   - 팝업 차단 아이콘 클릭
   - **"항상 localhost:5173의 팝업 허용"** 선택
   - 또는 **"팝업 허용"** 클릭

### 5-2. 사이트 설정에서 팝업 허용

1. **사이트 설정 열기**
   - Chrome 주소창 왼쪽 **자물쇠 아이콘** (🔒) 클릭
   - **"사이트 설정"** 클릭

2. **팝업 설정 변경**
   - **"팝업 및 리디렉션"** 섹션 찾기
   - **"허용"** 선택

---

## ✅ 최종 확인 체크리스트

- [ ] Google Cloud Console > OAuth 동의 화면 > 테스트 사용자에 `jaeman2034@gmail.com` 추가됨
- [ ] Google Cloud Console > API 라이브러리 > Identity Toolkit API 활성화됨
- [ ] 브라우저 캐시 완전 삭제 완료
- [ ] 시크릿 모드에서 테스트 완료
- [ ] 팝업 차단 해제 완료

---

## 🚨 문제가 계속되면

### 추가 확인 사항:

1. **Firebase Console > Authentication > 로그인 방법**
   - Google이 **"사용 설정됨"** 상태인지 다시 확인

2. **Google Cloud Console > OAuth 클라이언트**
   - 승인된 JavaScript 원본에 `http://localhost:5173` 포함 확인
   - 승인된 리디렉션 URI에 `http://localhost:5173/__/auth/handler` 포함 확인 (언더스코어 2개)

3. **브라우저 콘솔 확인**
   - F12 > Console 탭
   - Google 로그인 버튼 클릭 시 나타나는 오류 메시지 확인
   - Network 탭에서 실패한 요청 확인

4. **개발 서버 재시작**
   - 터미널에서 Ctrl + C로 서버 중지
   - `npm run dev`로 서버 재시작

---

## 💡 팁

- **시크릿 모드**는 캐시와 쿠키 없이 테스트할 수 있어서 문제 진단에 유용합니다
- **OAuth 동의 화면의 테스트 사용자**는 외부 사용자 유형일 때 필수입니다
- **Identity Toolkit API**는 Firebase Auth가 Google 로그인을 사용하기 위해 필요합니다
- 설정 변경 후 **2-3분 대기**하면 변경사항이 반영됩니다

