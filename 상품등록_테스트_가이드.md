# 🛒 상품 등록 테스트 가이드

## ✅ 현재 상황

**Storage 에뮬레이터가 꺼져 있습니다!** ❌

상품 등록 테스트를 위해서는 **Storage 에뮬레이터가 필수**입니다.

## 🔧 해결 방법

### 1. 에뮬레이터 재시작 (가장 간단)

현재 실행 중인 에뮬레이터를 종료하고 다시 시작하세요:

```bash
# 현재 에뮬레이터 종료 (Ctrl+C)
# 그 다음:
firebase emulators:start
```

이렇게 하면 `firebase.json`에 설정된 모든 에뮬레이터가 시작됩니다:
- ✅ Functions (포트 5001)
- ✅ Firestore (포트 8080)
- ✅ **Storage (포트 9199)** ← 이제 켜집니다!
- ✅ Auth (포트 9099)

### 2. Storage만 명시적으로 시작

```bash
firebase emulators:start --only storage,firestore,auth,functions
```

## 📋 상품 등록에 필요한 에뮬레이터

### 필수:
1. **Storage** ✅ (이미지 업로드)
2. **Firestore** ✅ (상품 데이터 저장)
3. **Auth** ✅ (사용자 인증)
4. **Functions** ✅ (AI 이미지 분석)

## 🚀 테스트 순서

### 1. 에뮬레이터 재시작
```bash
firebase emulators:start
```

### 2. Emulator UI 확인
- `http://127.0.0.1:4000` 접속
- **Storage 에뮬레이터가 ON**인지 확인

### 3. 브라우저에서 테스트
- `http://localhost:5173/market/create` 또는 상품 등록 페이지 접속
- 이미지 선택
- 제목, 가격 입력
- 등록 버튼 클릭

### 4. 결과 확인
- Emulator UI에서 Storage 확인: 업로드된 이미지 확인
- Firestore에서 `marketProducts` 컬렉션 확인: 새 상품 데이터 확인

## 💡 추가 팁

### Emulator 연결 확인

`src/lib/firebase.ts`에 Emulator 연결 코드가 추가되었습니다. `.env.local` 파일에 다음을 추가하세요:

```env
VITE_USE_EMULATOR=true
```

이렇게 하면 개발 모드에서 자동으로 Emulator에 연결됩니다.

### 포트 확인

Storage 에뮬레이터 포트 충돌 확인:
```bash
netstat -ano | findstr :9199
```

충돌이 있으면 다른 포트 사용:
```json
"storage": {
  "port": 9200
}
```

## ✅ 체크리스트

- [ ] 에뮬레이터 재시작 완료
- [ ] Storage 에뮬레이터 ON 확인
- [ ] `.env.local`에 `VITE_USE_EMULATOR=true` 추가
- [ ] 개발 서버 재시작 (`npm run dev`)
- [ ] 상품 등록 페이지 접속
- [ ] 이미지 업로드 테스트
- [ ] Firestore에 저장 확인

---

**🚀 에뮬레이터를 재시작하면 Storage가 자동으로 켜집니다!**

