rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // íŒ€ ë¬¸ì„œ: íŒ€ ë©¤ë²„ë§Œ ì½ê¸° ê°€ëŠ¥, Ownerë§Œ ì“°ê¸° ê°€ëŠ¥
    match /teams/{teamId} {
      // ì½ê¸°: íŒ€ ë©¤ë²„ (owners, coaches, members) ë˜ëŠ” ê´€ë¦¬ì
      allow read: if request.auth != null && (
        request.auth.uid in resource.data.get('owners', []) ||
        request.auth.uid in resource.data.get('coaches', []) ||
        request.auth.uid in resource.data.get('members', []) ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      
      // ì“°ê¸°: Ownerë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && 
                     request.auth.uid in resource.data.get('owners', []);
      
      // íŒ€ ë¦¬í¬íŠ¸
      match /reports/{reportId} {
        allow read: if request.auth != null;
        allow write: if request.auth != null && 
                       request.auth.uid in get(/databases/$(database)/documents/teams/$(teamId)).data.get('owners', []);
        
        // í’ˆì§ˆ ë¦¬í¬íŠ¸
        match /qualityReports/{qualityReportId} {
          allow read: if request.auth != null;
          allow create: if request.auth != null;
          allow update, delete: if false; // Functionsì—ì„œë§Œ ê´€ë¦¬
        }
      }
      
      // ì—­í•  ê´€ë¦¬
      match /roles/{userId} {
        allow read: if request.auth != null && request.auth.uid == userId;
        allow write: if request.auth != null && 
                       request.auth.uid in get(/databases/$(database)/documents/teams/$(teamId)).data.get('owners', []);
      }
      
      // ì•Œë¦¼ ë¡œê·¸: Owner ë° ê´€ë¦¬ìë§Œ ì½ê¸° ê°€ëŠ¥
      match /alerts/{alertId} {
        allow read: if request.auth != null && (
          request.auth.uid in get(/databases/$(database)/documents/teams/$(teamId)).data.get('owners', []) ||
          request.auth.token.email.matches('.*@yagovibe\\.com$') ||
          request.auth.token.email.matches('.*admin.*')
        );
        allow write: if false; // Functionsì—ì„œë§Œ ì“°ê¸°
      }
    }
    
    // Step 59-60: Proactive Insights
    match /insightSubs/{subId} {
      allow read: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
    }
    
    // Step 20: AI ì£¼ê°„ ì¸ì‚¬ì´íŠ¸
    match /insights/{insightId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }

    match /insightReports/{reportId} {
      // ì½ê¸°: íŒ€ ë©¤ë²„ ë˜ëŠ” ê´€ë¦¬ì
      allow read: if request.auth != null && (
        // ë³´ê³ ì„œì˜ teamIdë¡œ íŒ€ ë¬¸ì„œ í™•ì¸
        request.auth.uid in get(/databases/$(database)/documents/teams/$(resource.data.teamId)).data.get('owners', []) ||
        request.auth.uid in get(/databases/$(database)/documents/teams/$(resource.data.teamId)).data.get('coaches', []) ||
        request.auth.uid in get(/databases/$(database)/documents/teams/$(resource.data.teamId)).data.get('members', []) ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      
      // ì“°ê¸° (ìŠ¹ì¸/ë°˜ë ¤): Owner ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow update: if request.auth != null && (
        request.auth.uid in get(/databases/$(database)/documents/teams/$(resource.data.teamId)).data.get('owners', []) ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      
      // ìƒì„±: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow create: if false;
      
      // ì‚­ì œ: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow delete: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
    }
    
    // Step 26 & Step 62: ê°ì‚¬ ë¡œê·¸ (Audit Logs)
    match /auditLogs/{logId} {
      // ì½ê¸°: ê´€ë¦¬ì(role="admin") ë˜ëŠ” ê´€ë¦¬ì ì´ë©”ì¼ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.role == "admin" ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: ì¸ì¦ëœ ì‚¬ìš©ìê°€ ìì‹ ì˜ ì•¡ì…˜ì„ ê¸°ë¡ ê°€ëŠ¥ (uid ì¼ì¹˜)
      allow create: if request.auth != null && 
                       request.resource.data.uid == request.auth.uid;
      // ìˆ˜ì •/ì‚­ì œ: ë¶ˆê°€ (ê°ì‚¬ ë¡œê·¸ëŠ” ë³€ê²½ ë¶ˆê°€)
      allow update, delete: if false;
    }

    // Step 27: ì›Œí¬í”Œë¡œìš° ë¡œê·¸ (Workflow Logs)
    match /workflowLogs/{logId} {
      // ì½ê¸°: ê´€ë¦¬ì ë˜ëŠ” ë§¤ë‹ˆì €ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.role == "admin" ||
        request.auth.token.role == "manager" ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥ (í´ë¼ì´ì–¸íŠ¸ëŠ” ì½ê¸°ë§Œ ê°€ëŠ¥)
      allow write: if false;
    }

    // Step 28: ì›Œí¬í”Œë¡œìš° í†µê³„ (Workflow Stats)
    match /workflowStats/{statId} {
      // ì½ê¸°: ê´€ë¦¬ì ë˜ëŠ” ë§¤ë‹ˆì €ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.role == "admin" ||
        request.auth.token.role == "manager" ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥ (í´ë¼ì´ì–¸íŠ¸ëŠ” ì½ê¸°ë§Œ ê°€ëŠ¥)
      allow write: if false;
    }

    // Step 31: ë² íƒ€ í”¼ë“œë°± (Beta Feedback)
    match /betaFeedback/{feedbackId} {
      // ì½ê¸°: ê´€ë¦¬ì ë˜ëŠ” ë§¤ë‹ˆì €ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.role == "admin" ||
        request.auth.token.role == "manager" ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functions/HTTPS APIì—ì„œë§Œ ê°€ëŠ¥ (ì›¹ ì§ì ‘ ì ‘ê·¼ì€ rate-limit í•„ìš”)
      // ì‹¤ì œë¡œëŠ” feedbackApi í•¨ìˆ˜ë¥¼ í†µí•´ë§Œ ì“°ê¸° ê°€ëŠ¥í•˜ë„ë¡ ì œí•œ
      allow write: if false;
    }

    // Step 32: ë¦´ë¦¬ì¦ˆ ì²´í¬ ë° ë…¸íŠ¸ (Release Checks & Notes)
    match /releaseChecks/{checkId} {
      // ì½ê¸°: ê´€ë¦¬ì ë˜ëŠ” ë§¤ë‹ˆì €ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.role == "admin" ||
        request.auth.token.role == "manager" ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }

    match /releaseNotes/{noteId} {
      // ì½ê¸°: ê´€ë¦¬ì ë˜ëŠ” ë§¤ë‹ˆì €ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.role == "admin" ||
        request.auth.token.role == "manager" ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /modelCards/{cardId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥ (ê³µê°œ ì •ë³´)
      allow read: if request.auth != null;
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
    }
    
    // Step 63: Compliance Export & DSAR
    match /complianceExports/{exportId} {
      // ì½ê¸°: Owner ë˜ëŠ” SecOps(ê´€ë¦¬ì)ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.uid == resource.data.uid ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /dsarRequests/{requestId} {
      // ì½ê¸°: ìš”ì²­ì ë˜ëŠ” SecOps(ê´€ë¦¬ì)ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.uid == resource.data.uid ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /deletionRequests/{requestId} {
      // ì½ê¸°: ìš”ì²­ì ë˜ëŠ” SecOps(ê´€ë¦¬ì)ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.uid == resource.data.uid ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /systemLogs/{logId} {
      // ì½ê¸°: SecOps(ê´€ë¦¬ì)ë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    // Step 64: Global Governance Portal
    match /policies/{policyId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥ (ê³µê°œ ì •ë³´)
      allow read: if request.auth != null;
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥ (policyCompiler)
      allow write: if false;
    }
    
    // Step 65: Multi-Tenant Org Rollout & Billing Guard
    match /orgs/{orgId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥ (ê³µê°œ ì •ë³´)
      allow read: if request.auth != null;
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
    }
    
    match /tenants/{tenantId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
    }
    
    match /plans/{planId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥ (ê³µê°œ ì •ë³´)
      allow read: if request.auth != null;
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
    }
    
    match /usage/{day}/{orgId} {
      // ì½ê¸°: í•´ë‹¹ ì¡°ì§ ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.uid == orgId ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /ratelimits/{limitId} {
      // ì½ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /billingDaily/{billId} {
      // ì½ê¸°: í•´ë‹¹ ì¡°ì§ ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.uid == resource.data.orgId ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /featureOverrides/{orgId} {
      // ì½ê¸°: í•´ë‹¹ ì¡°ì§ ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.uid == orgId ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
    }
    
    // Step 68: Real-World Pilot & Telemetry Review
    match /events/{day}/{eventId} {
      // ì½ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /telemetryDaily/{docId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥ (ê³µê°œ ì •ë³´)
      allow read: if request.auth != null;
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    match /improvements/{docId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: Functions ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
    }
    
    match /pilotRollbacks/{docId} {
      // ì½ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    // Step 69: Production Hardening - í—¬ìŠ¤ì²´í¬ìš© ì„ì‹œ ì»¬ë ‰ì…˜
    match /_health/{docId} {
      // ì½ê¸°/ì“°ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read, write: if request.auth != null;
    }
    
    // Step 69: Production Hardening - ëŸ°ë¶ í…œí”Œë¦¿
    match /runbookTemplates/{docId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*') ||
        request.auth.token.role in ['owner', 'admin']
      );
    }
    
    // Step 69: Production Hardening - ë¡ ì¹˜ í”Œëœ
    match /launchPlans/{docId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*') ||
        request.auth.token.role in ['owner', 'admin']
      );
    }
    
    // Step 70: Post-Launch SRE & Growth Experiments
    match /slo/{metricId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*') ||
        request.auth.token.role in ['owner', 'admin']
      );
    }
    
    match /experiments/{expId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*') ||
        request.auth.token.role in ['owner', 'admin']
      );
      
      // ì‹¤í—˜ í• ë‹¹
      match /assign/{userId} {
        // ì½ê¸°: ë³¸ì¸ ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
        allow read: if request.auth != null && (
          request.auth.uid == userId ||
          request.auth.token.email.matches('.*@yagovibe\\.com$') ||
          request.auth.token.email.matches('.*admin.*')
        );
        // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥ (abRouter)
        allow write: if false;
      }
    }
    
    match /sessions/{userId} {
      // ì½ê¸°: ë³¸ì¸ ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.uid == userId ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: ë³¸ì¸ë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && request.auth.uid == userId;
      
      // ì„¸ì…˜ ë°©ë¬¸ ê¸°ë¡
      match /visits/{visitId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
    }
    
    match /retention/{docId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    // Step 71: Multi-Modal AI Extensions & Voice UX 2.0
    match /plugins/{pluginId} {
      // ì½ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥
      allow read: if request.auth != null;
      // ì“°ê¸°: ì†Œìœ ì(ownerId) ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow write: if request.auth != null && (
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*') ||
        request.auth.token.role in ['owner', 'admin'] ||
        request.auth.uid == request.resource.data.ownerId
      );
    }
    
    match /assistantLogs/{logId} {
      // ì½ê¸°: ë³¸ì¸ ë˜ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥
      allow read: if request.auth != null && (
        request.auth.uid == resource.data.userId ||
        request.auth.token.email.matches('.*@yagovibe\\.com$') ||
        request.auth.token.email.matches('.*admin.*')
      );
      // ì“°ê¸°: Functionsì—ì„œë§Œ ê°€ëŠ¥
      allow write: if false;
    }
    
    // ğŸ”§ ê°œë°œ/í…ŒìŠ¤íŠ¸ìš© ì»¬ë ‰ì…˜ (ì—ë®¬ë ˆì´í„°ì—ì„œ ì‚¬ìš©)
    match /testConnection/{docId} {
      // ì½ê¸°/ì“°ê¸°: ì¸ì¦ëœ ì‚¬ìš©ì ëª¨ë‘ ê°€ëŠ¥ (ê°œë°œìš©)
      allow read, write: if request.auth != null;
    }
    
    // ğŸ›’ ë§ˆì¼“ ìƒí’ˆ (Market Products)
    // âœ… í…ŒìŠ¤íŠ¸ìš© â€” ì—ë®¬ë ˆì´í„°ì—ì„œ ëª¨ë“  ìš”ì²­ í—ˆìš©
    match /marketProducts/{productId} {
      allow read, write: if true;
    }
    
    // ğŸ”¥ FCM í‘¸ì‹œ ì•Œë¦¼ - ì‚¬ìš©ì ê¸°ê¸° í† í° ì €ì¥
    // users/{uid}/devices/{deviceId}
    match /users/{userId}/devices/{deviceId} {
      // ì½ê¸°/ì“°ê¸°: ë³¸ì¸ë§Œ ê°€ëŠ¥
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}

